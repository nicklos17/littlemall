!function(){"use strict";var o=baseController.extend({init:function(o,r,e,n){this._super(o),o.sn=n.sn,r.getRequest(shopModuleConfig.domain+"/support/apply?orderSn="+o.sn).then(function(n){if(0==n.ret)return alert("错误的订单号~"),e.path("/order"),!1;o.goods=[];for(var d in n.orderGoods)o.goods[d]=n.orderGoods[d],3==n.orderGoods[d].ord_goods_back?o.goods[d].dis=!0:o.goods[d].dis=!1;o.orderInfo=n.orderInfo,o.orderInfo.goods_num=1,o.bordReason=["请选择申请原因","尺码原因","快递原因","鞋体原因","智能模块原因","发错货","其他"],o.bordReasonChoose="0",o.bordModelChoose="0",o.bordModels={},o.bordModels[0]={tit:"请先选择售后类型"},n.nowTime-n.confirmTime<=shopModuleConfig.supportTime.back&&(o.bordModels[1]={tit:"退货"}),n.nowTime-n.confirmTime<=shopModuleConfig.supportTime.exchange&&(o.bordModels[3]={tit:"换货"}),n.nowTime-n.confirmTime<=shopModuleConfig.supportTime.supportTime&&(o.bordModels[5]={tit:"智能模块更换"}),r.postRequest(shopModuleConfig.domain+"/region/getProvinces",{}).then(function(r){o.provinces=r,o.choosePro(o.orderInfo.order_province),o.chooseCity(o.orderInfo.order_city)},function(o){})},function(o){return alert("错误的订单号~"),e.path("/order"),!1}),o.chooseBordGoods=function(r,e){return 1==e?!1:void(o.chooseBordGoodsId=r)},o.confirmBord=function(){return 0==o.bordModelChoose?(alert("请选择售后类型"),!1):0==o.bordReasonChoose?(alert("请选择申请原因"),!1):o.chooseBordGoodsId?void r.postRequest(shopModuleConfig.domain+"/support/addSupport",{bord_type:o.bordModelChoose,order_goods_id:o.chooseBordGoodsId,goods_num:o.orderInfo.goods_num,bord_reason:o.bordReasonChoose,bord_msg:o.bordMsg,pro:o.orderInfo.order_province,city:o.orderInfo.order_city,dis:o.orderInfo.order_district,addr_detail:o.orderInfo.order_addr,consignee:o.orderInfo.order_consignee,mobile:o.orderInfo.order_mobile,area_code:o.orderInfo.areaCode?o.orderInfo.areaCode:"",tel_num:o.orderInfo.telNum?o.orderInfo.telNum:"",ext:o.orderInfo.ext?o.orderInfo.ext:"",order_sn:o.sn}).then(function(o){return 0==o.ret?(alert(o.msg),!1):(alert("申请成功,请耐心等待客服处理~"),void e.path("/support"))},function(o){return alert("申请失败, 请重试~"),!1}):(alert("请选择需要售后的商品"),!1)},o.choosePro=function(n){r.postRequest(shopModuleConfig.domain+"/region/getCities",{pro_id:n}).then(function(r){o.citits=r},function(o){e.path("/order")})},o.chooseCity=function(e){r.postRequest(shopModuleConfig.domain+"/region/getDistricts",{city_id:e}).then(function(r){o.districts=r},function(o){})}},defineListeners:function(){this._super()},destroy:function(){}});o.$inject=["$scope","uriServices","$location","$routeParams"],angular.module("controllers.supportApply",[]).controller("supportApplyCtrl",o)}();