!function(){"use strict";var d=baseController.extend({init:function(d,e,a,t){this._super(d),d.citits=[{city_id:0,city_name:"请先选择省份"}],d.districts=[{dis_id:0,dis_name:"请先选择市区"}],d.addr={};var r=t.addrId;r&&e.postRequest(shopModuleConfig.domain+"/address/getAddr",{aid:r}).then(function(e){if(1==e.ret){var t=e.data.u_addr_tel.split("-");3==e.data.u_addr_default?d.addr.defaultAddr=!0:d.addr.defaultAddr=!1,d.addr.addrId=e.data.u_addr_id,d.addr.consignee=e.data.u_addr_consignee,d.addr.mobile=e.data.u_addr_mobile,d.addr.areaCode=t[0],d.addr.telNum=t[1],d.addr.ext=t[2],d.addr.proId=e.data.pro_id,d.addr.cityId=e.data.city_id,d.addr.disId=e.data.dis_id,d.addr.detailAddr=e.data.u_addr_info,d.addr.zipCode=e.data.u_addr_zipcode,d.choosePro(d.addr.proId),d.chooseCity(d.addr.cityId)}else a.path("/addr")},function(d){a.path("/addr")}),e.postRequest(shopModuleConfig.domain+"/region/getProvinces",{}).then(function(e){d.provinces=e},function(d){a.path("")}),d.choosePro=function(t){e.postRequest(shopModuleConfig.domain+"/region/getCities",{pro_id:t}).then(function(e){d.citits=e},function(d){a.path("")})},d.chooseCity=function(t){e.postRequest(shopModuleConfig.domain+"/region/getDistricts",{city_id:t}).then(function(e){d.districts=e},function(d){a.path("")})},d.saveAddr=function(){return d.addr.detailAddr?void e.postRequest(shopModuleConfig.domain+"/address/add",{consignee:d.addr.consignee,areaCode:d.addr.areaCode?d.addr.areaCode:"",pro:d.addr.proId,city:d.addr.cityId,dis:d.addr.disId,detailAddr:d.addr.detailAddr?d.addr.detailAddr:"",zipCode:d.addr.zipCode,telNum:d.addr.telNum?d.addr.telNum:"",ext:d.addr.ext?d.addr.ext:"",mobile:d.addr.mobile}).then(function(t){return 1!=t.ret?(alert(t.msg),!1):(alert("添加成功~"),void(-1!=a.url().indexOf("addrAdd")?a.path("/addr"):(e.getRequest(shopModuleConfig.domain+"/order/confirm").then(function(e){d.$parent.addrList=e.addressList},function(d){alert("网络延迟, 请刷新页面")}),d.addAddr=!1)))},function(d){a.path("")}):(alert("请先填写详细地址"),!1)},d.editAddr=function(){e.postRequest(shopModuleConfig.domain+"/address/edit",{addrId:r,consignee:d.addr.consignee,areaCode:d.addr.areaCode?d.addr.areaCode:"",pro:d.addr.proId,city:d.addr.cityId,dis:d.addr.disId,detailAddr:d.addr.detailAddr?d.addr.detailAddr:"",zipCode:d.addr.zipCode,telNum:d.addr.telNum?d.addr.telNum:"",ext:d.addr.ext?d.addr.ext:"",mobile:d.addr.mobile}).then(function(e){return 1!=e.ret?(alert(e.msg),!1):(alert("编辑成功~"),a.path("/addr"),void(d.addAddr=!1))},function(d){a.path("/addr")})},d.setDefaultAddr=function(t){var r;r=d.addr.defaultAddr?"/address/cancelDefault":"/address/setDefault",e.postRequest(shopModuleConfig.domain+r,{aid:t}).then(function(e){1==e.ret&&(d.addr.defaultAddr=!d.addr.defaultAddr)},function(d){a.path("/addr")})}},defineListeners:function(){this._super()},destroy:function(){}});d.$inject=["$scope","uriServices","$location","$routeParams"],angular.module("controllers.address",[]).controller("addressCtrl",d)}();