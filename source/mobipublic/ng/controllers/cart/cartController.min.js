!function(){"use strict";var t=baseController.extend({init:function(t,a,c){this._super(t),a.getRequest(shopModuleConfig.domain+"/cart/index/").then(function(a){0==a.length&&(alert("购物车为空,请先购买商品~"),c.path("/")),t.cartList=a,t.totalNum=0,t.checkNum=0,t.totalPrice=0;for(var e in a)1!=a[e].goods_status||a[e].checked||(t.checkNum++,t.totalNum++,t.totalPrice=(parseFloat(t.totalPrice)+100*parseFloat(a[e].goods_price)*parseInt(a[e].car_good_num)/100).toFixed(2))},function(t){c.path("/")}),t.checkData=function(a){t.cartList[a].checked?(t.checkNum++,t.totalPrice=(parseFloat(t.totalPrice)+100*parseFloat(t.cartList[a].goods_price)*parseInt(t.cartList[a].car_good_num)/100).toFixed(2)):(t.checkNum--,t.totalPrice=(parseFloat(t.totalPrice)-100*parseFloat(t.cartList[a].goods_price)*parseInt(t.cartList[a].car_good_num)/100).toFixed(2)),t.cartList[a].checked=!t.cartList[a].checked},t.delData=function(e){a.postRequest(shopModuleConfig.domain+"/cart/del",{gid:t.cartList[e].goods_id,"attrs-ids":t.cartList[e].attrs_ids}).then(function(a){1==a.ret?(t.cartList[e].checked||(t.checkNum--,t.totalPrice=(parseFloat(t.totalPrice)-100*parseFloat(t.cartList[e].goods_price)*parseInt(t.cartList[e].car_good_num)/100).toFixed(2)),t.totalNum--,t.cartList.splice(e,1),0==t.cartList.length&&(alert("请选择商品购买~"),c.path("/"))):alert("删除失败,请重试~")},function(t){c.path("/")})},t.chkAll=function(){if(t.totalNum!=t.checkNum){var a=0,c=t.cartList.length;for(a;c>a;a++)1==t.cartList[a].goods_status&&t.cartList[a].checked&&(t.cartList[a].checked=!1,t.checkNum++,t.totalPrice=(parseFloat(t.totalPrice)+100*parseFloat(t.cartList[a].goods_price)*parseInt(t.cartList[a].car_good_num)/100).toFixed(2))}},t.buy=function(){if(!t.checkNum)return alert("请先选择购买的商品~"),!1;var a={},e=0,r=t.cartList.length;for(e;r>e;e++)1!=t.cartList[e].goods_status||t.cartList[e].checked||(a[e]={a:t.cartList[e].attrs_ids,g:t.cartList[e].goods_id});localStorage.setItem("confirmData",JSON.stringify(a)),c.path("/confirm")}},defineListeners:function(){this._super()},destroy:function(){}});t.$inject=["$scope","uriServices","$location"],angular.module("controllers.cart",[]).controller("cartCtrl",t)}();